\begin{Boxfig}{DaBit protocol generation}{fig:dabit-protocol}
  {Protocol $\mathsf{DaBit}_{[D, P_1, P_2]}(\shape)$}
  \begin{enumerate}
  \item On D:
  \begin{enumerate}
    \item $k \sample \mathsf{GenPrfKey}()$.
    \item $\seed \asn \derives(0; k)$.
    \item $\vb \asn \RingSample(\seed, \shape, \{0, 1\})$.
    \item Compute $\seed(\textsf{bin}) \asn \derives(1, k)$ and $\seed(\textsf{ring}) \asn \derives(2, k)$.
    \item Send $\seed(\textsf{bin})$ and $\seed(\textsf{ring})$ to $P_1$.

  \end{enumerate}
  \item On $P_1$:
 \begin{enumerate}
     \item Receive $\seed(\textsf{bin})$ and $\seed(\textsf{ring})$ from Dealer.
     \item Locally compute $\vb^1_{2^k} \asn \RingSample(\seed(\textsf{ring}), \shape, \Z_{2^k})$.
     \item Locally compute $\vb^1_{2} \asn \RingSample(\seed(\textsf{bin}), \shape, \{0, 1\})$.
 \end{enumerate}
\item On D:
\begin{enumerate}
    \item Sample $\vb^1_{2^k} \asn \RingSample(\seed(\textsf{ring}), \shape, \Z_{2^k})$. Set $\vb^2_{2^k} = \vb - \vb^1_{2^k}$.
    \item Sample $\vb^1_{2} \asn \RingSample(\seed(\textsf{bin}), \shape, \{0, 1\})$. Set $\vb^2_{2} = \vb - \vb^1_{2}$.
    \item Send $\vb^2_{2^k}$ and $\vb^2_2$ to $P_2$.
\end{enumerate}
\item On $P_2$:
\begin{enumerate}
    \item Receive $\vb^2_{2^k}$ and $\vb^2_2$ from Dealer.
\end{enumerate}
\item Let $\shareR{\vb}^\mathsf{add} = (\vb^1_{2^k}, \vb^2_{2^k})$ and $\shareB{\vb}^\mathsf{add} = (\vb^1_2, \vb^2_2)$. Output $(\shareR{\vb}^\mathsf{add}, \shareB{\vb}^\mathsf{add})$.
\end{enumerate}
\end{Boxfig}

