
\begin{Boxfig}{Additive to replicated share conversion protocol for semi-honest
replicated secret sharing.}{fig:two-to-three}{$\mathsf{AdditiveToRep}[P_1, P_2, P_3](\share{\vx})$}
\begin{enumerate}
\item Let $(\vx^1, \vx^2, \bot^3) = \share{\vx}$ such that $\vx^1 + \vx^2 = \vx$.
\item On $P_3$:
\begin{enumerate}
  \item Sample seeds $\seed(i) \sample \derives(\dkey_3, \GenNonce)$ for $i \in [1, 2]$. Send $\seed(i)$ to $P_i$.
  \item Compute $\vy_1 \sample \RingSample(\seed(1), \vx.\shape, \Z_{2^k})$
  and $\vy_3 \sample \RingSample(\seed(2), \vx.\shape, \Z_{2^k})$.
  \item Set
  the output share as $(\vy_3, \vy_1)$.
\end{enumerate}

\item On $P_i$ for $i \in [1,2]$:
\begin{enumerate}
   \item Receive $\seed(i)$ from $P_3$ and compute $\vy^i = \RingSample(\seed(i), \vx.\shape, \Z_{2^k})$.
  \item Set $\vy^i = \share{\vy}$ as an additive sharing of $\vy$.
\end{enumerate}
\item With Additive($P_1, P_2$)
\begin{enumerate}
  \item Run $\Open(\share{\vx} - \share{\vy})$ between $P_1$ and $P_2$. Store $\vc$ as the output
to the $\Open$ protocol.
\end{enumerate}
\item On $P_1$:
\begin{enumerate}
  \item Set the output share as $(\vy_1, \vx - \vy_1 + \vc)$.
\end{enumerate}
\item On $P_2$:
\begin{enumerate}
  \item Set the output share as $(\vx - \vy_2 + \vc, \vy_2)$.
\end{enumerate}
\end{enumerate}
\end{Boxfig}

