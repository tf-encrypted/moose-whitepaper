
\begin{Boxfig}{$(2,2)$ to $(2,3)$ share conversion protocol for semi-honest
RSS.}{fig:two-to-three}{Protocol $\Proto{(2,2) \rightarrow (2,3)}(\share{\vx})$}
Input is $\share{\vx}$ which is additively shared amongst $P_1$ and $P_2$.
Party $P_1$ holds $\vx^1$ and $P_2$ holds $\vx^2$ such that $\vx^1 + \vx^2 = \vx$. \\
On $P_3$:
\begin{enumerate}
  \item Sample key $k \sample \mathsf{SampleKey}()$.
  \item Sample seeds $\seed(i) \sample \derives(k, i)$ for $i \in [1, 2]$. Send $\seed(i)$ to $P_i$.
  \item Compute $\vy_1 \sample \RingSample(\seed(1), \vx.\shape, \Z_{2^k})$
  and $\vy_3 \sample \RingSample(\seed(2), \vx.\shape, \Z_{2^k})$.
  \item Set
  the output share as $(\vy_3, \vy_1)$.
\end{enumerate}

On $P_i$ for $i \in [1,2]$:
\begin{enumerate}
   \item Receive $\seed(i)$ from $P_3$ and compute $\vy_i = \RingSample(\seed(i), \vx.\shape, \Z_{2^k})$.
   \item Run $\Proto{\Open}^{(2,2)}(\vx - \vy)$ between $P_1$ and $P_2$. Store $\vc$ as the output
   to the $\Open$ protocol.
\end{enumerate}

On $P_1$:
\begin{enumerate}
  \item Set the output share as $(\vy_1, \vx - \vy_1 + \vc)$.
\end{enumerate}
On $P_2$:
\begin{enumerate}
  \item Set the output share as $(\vx - \vy_2 + \vc, \vy_2)$.
\end{enumerate}
\end{Boxfig}

